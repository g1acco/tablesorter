(function(factory){if (typeof define === 'function' && define.amd){define(['jquery'], factory);} else if (typeof module === 'object' && typeof module.exports === 'object'){module.exports = factory(require('jquery'));} else {factory(jQuery);}}(function(jQuery){
let nonceElement=document.getElementById("csp-nonce"),NONCE=nonceElement?nonceElement.content:null;(h=>{var f=h.tablesorter,a=".tscolsel",S=f.columnSelector={queryAll:"@media only all { [columns] { display: none; } } ",queryBreak:"@media all and (min-width: [size]) { [columns] { display: table-cell; } } ",init:function(e,t,o){var l=f.debug(t,"columnSelector"),n=h(o.columnSelector_layout);n.find("input").add(n.filter("input")).length?(t.$table.addClass(t.namespace.slice(1)+"columnselector"),(n=t.selector={$container:h(o.columnSelector_container||"<div>")}).$style=h('<style nonce="'+NONCE+'"></style>').prop("disabled",!0).appendTo("head"),n.$breakpoints=h('<style nonce="'+NONCE+'"></style>').prop("disabled",!0).appendTo("head"),n.isInitializing=!0,S.setUpColspan(t,o),S.setupSelector(t,o),o.columnSelector_mediaquery&&S.setupBreakpoints(t,o),n.isInitializing=!1,n.$container.length?S.updateCols(t,o):l&&console.warn("ColumnSelector >> container not found"),t.$table.off("refreshColumnSelector"+a).on("refreshColumnSelector"+a,function(e,t,o){S.refreshColumns(this.config,t,o)}),l&&console.log("ColumnSelector >> Widget initialized")):l&&console.error("ColumnSelector >> ERROR: Column Selector aborting, no input found in the layout! ***")},refreshColumns:function(e,t,o){var l,n,a,c,r=e.selector,s=h.isArray(o||t),u=e.widgetOptions;if(null!=t&&r.$container.length){if("selectors"===t&&(r.$container.empty(),S.setupSelector(e,u),S.setupBreakpoints(e,u),void 0===o)&&null!==o&&(o=r.auto),s)for(n=o||t,h.each(n,function(e,t){n[e]=parseInt(t,10)}),l=0;l<e.columns;l++)c=0<=h.inArray(l,n),(a=r.$container.find("input[data-column="+l+"]")).length&&(a.prop("checked",c),r.states[l]=c);c=!0===o||!0===t||"auto"===t&&!1!==o,a=r.$container.find('input[data-column="auto"]').prop("checked",c),S.updateAuto(e,u,a)}else S.updateBreakpoints(e,u),S.updateCols(e,u);S.saveValues(e,u),S.adjustColspans(e,u)},setupSelector:function(t,o){var e,l,n,a,c,r=t.selector,s=r.$container,u=o.columnSelector_saveColumns&&f.storage,i=u?f.storage(t.table,"tablesorter-columnSelector"):[],d=u?f.storage(t.table,"tablesorter-columnSelector-auto"):{};for(r.auto=h.isEmptyObject(d)||"boolean"!==h.type(d.auto)?o.columnSelector_mediaqueryState:d.auto,r.states=[],r.$column=[],r.$wrapper=[],r.$checkbox=[],e=0;e<t.columns;e++)c=(l=t.$headerIndexed[e]).attr(o.columnSelector_priority)||1,a=l.attr("data-column"),n=f.getColumnData(t.table,t.headers,a),d=f.getData(l,n,"columnSelector"),isNaN(c)&&0<c.length||"disable"===d||o.columnSelector_columns[a]&&"disable"===o.columnSelector_columns[a]?r.states[a]=null:(r.states[a]=i&&null!=i[a]?i[a]:null!=o.columnSelector_columns[a]?o.columnSelector_columns[a]:"true"===d||"false"!==d,r.$column[a]=h(this),s.length&&(n=l.attr(o.columnSelector_name)||l.text().trim(),"function"==typeof o.columnSelector_layoutCustomizer&&(c=l.find("."+f.css.headerIn),n=o.columnSelector_layoutCustomizer(c.length?c:l,n,parseInt(a,10))),r.$wrapper[a]=h(o.columnSelector_layout.replace(/\{name\}/g,n)).appendTo(s),r.$checkbox[a]=r.$wrapper[a].find("input").add(r.$wrapper[a].filter("input")).attr("data-column",a).toggleClass(o.columnSelector_cssChecked,r.states[a]).prop("checked",r.states[a]).on("change",function(){if(!r.isInitializing){var e=h(this).attr("data-column");if(!S.checkChange(t,this.checked))return this.checked=!this.checked,!1;t.selector.states[e]=this.checked,S.updateCols(t,o)}}).change()))},checkChange:function(e,t){for(var o=e.widgetOptions,l=o.columnSelector_maxVisible,o=o.columnSelector_minVisible,n=e.selector.states,a=n.length,c=0;0<=a--;)n[a]&&c++;return!(t&null!==l&&l<=c||!t&&null!==o&&c<=o)},setupBreakpoints:function(e,t){var o=e.selector;t.columnSelector_mediaquery&&(o.lastIndex=-1,S.updateBreakpoints(e,t),e.$table.off("updateAll"+a).on("updateAll"+a,function(){S.setupSelector(e,t),S.setupBreakpoints(e,t),S.updateBreakpoints(e,t),S.updateCols(e,t)})),o.$container.length&&(t.columnSelector_mediaquery&&(o.$auto=h(t.columnSelector_layout.replace(/\{name\}/g,t.columnSelector_mediaqueryName)).prependTo(o.$container),o.$auto.find("input").add(o.$auto.filter("input")).attr("data-column","auto").prop("checked",o.auto).toggleClass(t.columnSelector_cssChecked,o.auto).on("change",function(){S.updateAuto(e,t,h(this))}).change()),e.$table.off("update"+a).on("update"+a,function(){S.updateCols(e,t)}))},updateAuto:function(e,t,o){var l=e.selector;l.auto=o.prop("checked")||!1,h.each(l.$checkbox,function(e,t){t&&(t[0].disabled=l.auto,l.$wrapper[e].toggleClass("disabled",l.auto))}),t.columnSelector_mediaquery&&S.updateBreakpoints(e,t),S.updateCols(e,t),e.selector.$popup&&e.selector.$popup.find(".tablesorter-column-selector").html(l.$container.html()).find("input").each(function(){var e=h(this).attr("data-column");h(this).prop("checked","auto"===e?l.auto:l.states[e])}),S.saveValues(e,t),S.adjustColspans(e,t),l.auto&&e.$table.triggerHandler(t.columnSelector_updated)},addSelectors:function(e,t,o){var l=[],n=" col:nth-child("+o+")";return l.push(t+n+","+t+"_extra_table"+n),n=" tr:not(."+e.columnSelector_classHasSpan+') th[data-column="'+(o-1)+'"]',l.push(t+n+","+t+"_extra_table"+n),n=" tr:not(."+e.columnSelector_classHasSpan+") td:nth-child("+o+")",l.push(t+n+","+t+"_extra_table"+n),n=" tr td:not("+t+e.columnSelector_classHasSpan+')[data-column="'+(o-1)+'"]',l.push(t+n+","+t+"_extra_table"+n),l},updateBreakpoints:function(e,t){var o,l,n,a,c=[],r=e.selector,s=e.namespace+"columnselector",u=[],i="";if(t.columnSelector_mediaquery&&!r.auto)r.$breakpoints.prop("disabled",!0),r.$style.prop("disabled",!1);else{if(t.columnSelector_mediaqueryHidden)for(n=0;n<e.columns;n++)l=f.getColumnData(e.table,e.headers,n),c[n+1]="false"===f.getData(e.$headerIndexed[n],l,"columnSelector"),c[n+1]&&(u=u.concat(S.addSelectors(t,s,n+1)));for(o=0;o<t.columnSelector_maxPriorities;o++)a=[],e.$headers.filter("["+t.columnSelector_priority+"="+(o+1)+"]").each(function(){n=parseInt(h(this).attr("data-column"),10)+1,c[n]||(a=a.concat(S.addSelectors(t,s,n)))}),a.length&&(u=u.concat(a),i+=S.queryBreak.replace(/\[size\]/g,t.columnSelector_breakpoints[o]).replace(/\[columns\]/g,a.join(",")));r.$style&&r.$style.prop("disabled",!0),u.length&&r.$breakpoints.prop("disabled",!1).text(S.queryAll.replace(/\[columns\]/g,u.join(","))+i)}},updateCols:function(e,t){var o,l,n,a;t.columnSelector_mediaquery&&e.selector.auto||e.selector.isInitializing||(l=e.selector,n=[],a=e.namespace+"columnselector",l.$container.find("input[data-column]").filter('[data-column!="auto"]').each(function(){this.checked||(o=parseInt(h(this).attr("data-column"),10)+1,n=n.concat(S.addSelectors(t,a,o))),h(this).toggleClass(t.columnSelector_cssChecked,this.checked)}),t.columnSelector_mediaquery&&l.$breakpoints.prop("disabled",!0),l.$style&&l.$style.prop("disabled",!1).text(n.length?n.join(",")+" { display: none; }":""),S.saveValues(e,t),S.adjustColspans(e,t),e.$table.triggerHandler(t.columnSelector_updated))},setUpColspan:function(e,t){for(var o,l,n=h(window),a=!1,c=e.$table.add(h(e.namespace+"_extra_table")).children().children("tr").children("th, td"),r=c.length,s=0;s<r;s++)1<(o=c[s].colSpan)&&(a=!0,c.eq(s).addClass(e.namespace.slice(1)+"columnselector"+t.columnSelector_classHasSpan).attr("data-col-span",o),f.computeColumnIndex(c.eq(s).parent().addClass(t.columnSelector_classHasSpan)));a&&t.columnSelector_mediaquery&&(l=e.namespace+"columnselector",n.off(l).on("resize"+l,f.window_resize).on("resizeEnd"+l,function(){n.off("resize"+l,f.window_resize),S.adjustColspans(e,t),n.on("resize"+l,f.window_resize)}))},findHeaders:function(e){for(var t,o="."+f.css.scrollerHeader+" thead > tr > ",l=h(o+"th,"+o+"td"),n=[],a=0;a<e.columns;a++)t=l.filter('[data-column="'+a+'"]'),n[a]=t.length?(t.not(".sorter-false").length?t.not(".sorter-false"):t).filter(":last"):h();return n},adjustColspans:function(e,t){for(var o,l,n,a,c,r=e.selector,s=t.filter_filteredRow||"filtered",u=t.columnSelector_mediaquery&&r.auto,i=e.$table.children("thead, tfoot").children().children().add(h(e.namespace+"_extra_table").children("thead, tfoot").children().children()).add(e.$table.find(".group-header").children()),d=i.length,m=f.hasWidget(e.table,"scroller")?S.findHeaders(e):e.$headerIndexed,p=0;p<d;p++)if(c=i.eq(p),a=(l=parseInt(c.attr("data-column"),10)||c[0].cellIndex)+(n=parseInt(c.attr("data-col-span"),10)||1),1<n){for(o=l;o<a;o++)(!u&&!1===r.states[o]||u&&m[o]&&!m[o].is(":visible"))&&n--;n?c.removeClass(s)[0].colSpan=n:c.addClass(s)}else null!=r.states[l]&&c.toggleClass(s,!u&&!r.states[l])},saveValues:function(e,t){t.columnSelector_saveColumns&&f.storage&&(t=e.selector,f.storage(e.$table[0],"tablesorter-columnSelector-auto",{auto:t.auto}),f.storage(e.$table[0],"tablesorter-columnSelector",t.states))},attachTo:function(e,t){var o,l,n,a=(e=h(e)[0]).config,e=h(t);e.length&&a&&(e.find(".tablesorter-column-selector").length||e.append('<span class="tablesorter-column-selector"></span>'),o=a.selector,l=a.widgetOptions,e.find(".tablesorter-column-selector").html(o.$container.html()).find("input").each(function(){var e=h(this).attr("data-column"),e="auto"===e?o.auto:o.states[e];h(this).toggleClass(l.columnSelector_cssChecked,e).prop("checked",e)}),o.$popup=e.on("change","input",function(){if(!o.isInitializing){if(!S.checkChange(a,this.checked))return this.checked=!this.checked,!1;n=h(this).toggleClass(l.columnSelector_cssChecked,this.checked).attr("data-column"),o.$container.find('input[data-column="'+n+'"]').prop("checked",this.checked).trigger("change")}}))}};f.window_resize=function(){f.timer_resize&&clearTimeout(f.timer_resize),f.timer_resize=setTimeout(function(){h(window).trigger("resizeEnd")},250)},f.addWidget({id:"columnSelector",priority:10,options:{columnSelector_container:null,columnSelector_columns:{},columnSelector_saveColumns:!0,columnSelector_layout:'<label><input type="checkbox">{name}</label>',columnSelector_layoutCustomizer:null,columnSelector_name:"data-selector-name",columnSelector_mediaquery:!0,columnSelector_mediaqueryName:"Auto: ",columnSelector_mediaqueryState:!0,columnSelector_mediaqueryHidden:!1,columnSelector_maxVisible:null,columnSelector_minVisible:null,columnSelector_breakpoints:["20em","30em","40em","50em","60em","70em"],columnSelector_maxPriorities:6,columnSelector_priority:"data-priority",columnSelector_cssChecked:"checked",columnSelector_classHasSpan:"hasSpan",columnSelector_updated:"columnUpdate"},init:function(e,t,o,l){S.init(e,o,l)},remove:function(e,t,o,l){var n=t.selector;!l&&n&&(n&&n.$container.empty(),n.$popup&&n.$popup.empty(),n.$style.remove(),n.$breakpoints.remove(),h(t.namespace+"columnselector"+o.columnSelector_classHasSpan).removeClass(o.filter_filteredRow||"filtered"),t.$table.find("[data-col-span]").each(function(e,t){t=h(t);t.attr("colspan",t.attr("data-col-span"))}),t.$table.off("updateAll"+a+" update"+a))}})})(jQuery);return jQuery;}));
